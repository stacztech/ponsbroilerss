"use strict";(self.webpackChunkmeat_website=self.webpackChunkmeat_website||[]).push([[76],{2413:(v,_,a)=>{a.r(_),a.d(_,{AdminOrdersComponent:()=>P});var c=a(177),d=a(8326),e=a(5345),p=a(7519),g=a(7473),h=a(2522),u=a(4796);function m(s,l){if(1&s&&(e.j41(0,"option",13),e.EFF(1),e.k0s()),2&s){const t=l.$implicit;e.Y8G("value",t),e.R7$(1),e.JRh(t)}}function f(s,l){if(1&s){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"a",14),e.bIt("click",function(){const i=e.eBV(t).$implicit,o=e.XpG();return e.Njj(o.viewOrderDetail(i.id))}),e.EFF(3),e.k0s()(),e.j41(4,"td"),e.EFF(5),e.k0s(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"currency"),e.k0s(),e.j41(11,"td"),e.EFF(12),e.nI1(13,"date"),e.k0s()()}if(2&s){const t=l.$implicit,n=e.XpG();e.R7$(3),e.JRh(t.id),e.R7$(2),e.JRh(n.userIdToName[t.userId]),e.R7$(2),e.JRh(t.status),e.R7$(2),e.JRh(e.i5U(10,5,t.total,"INR")),e.R7$(3),e.JRh(e.i5U(13,8,t.orderDate,"medium"))}}function O(s,l){if(1&s){const t=e.RV6();e.j41(0,"span")(1,"button",17),e.bIt("click",function(){const i=e.eBV(t).index,o=e.XpG(2);return e.Njj(o.setPage(i+1))}),e.EFF(2),e.k0s()()}if(2&s){const t=l.index,n=e.XpG(2);e.R7$(1),e.AVh("active",n.page===t+1),e.R7$(1),e.JRh(t+1)}}const C=function(){return[]};function M(s,l){if(1&s){const t=e.RV6();e.j41(0,"div",15)(1,"button",16),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.setPage(r.page-1))}),e.EFF(2,"<"),e.k0s(),e.DNE(3,O,3,3,"span",11),e.j41(4,"button",16),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.setPage(r.page+1))}),e.EFF(5,">"),e.k0s()()}if(2&s){const t=e.XpG();e.R7$(1),e.Y8G("disabled",1===t.page),e.R7$(2),e.Y8G("ngForOf",e.lJ4(3,C).constructor(t.totalPages)),e.R7$(1),e.Y8G("disabled",t.page===t.totalPages)}}let P=(()=>{class s{constructor(t,n,r,i){this.ordersService=t,this.notificationService=n,this.router=r,this.authService=i,this.orders=[],this.filteredOrders=[],this.searchTerm="",this.filterStatus="",this.filterUser="",this.filterDate="",this.users=[],this.userNames=[],this.userIdToName={},this.page=1,this.pageSize=8,this.totalPages=1,this.isUpdating=null}ngOnInit(){this.loadUsersAndOrders()}loadUsersAndOrders(){this.authService.getAllUsers().subscribe({next:t=>{const n=t.users;this.userIdToName={},n.forEach(r=>{this.userIdToName[r._id||r.id]=r.name}),this.loadOrders()},error:()=>{this.userIdToName={},this.loadOrders()}})}loadOrders(){this.ordersService.getOrders().subscribe(t=>{this.orders=t.orders,this.users=Array.from(new Set(this.orders.map(n=>n.userId))),this.userNames=this.users.map(n=>this.userIdToName[n]).filter(n=>!!n),this.applyFilters()})}applyFilters(){let t=this.orders;this.searchTerm&&(t=t.filter(n=>n.id.toLowerCase().includes(this.searchTerm.toLowerCase())||(this.userIdToName[n.userId]||"").toLowerCase().includes(this.searchTerm.toLowerCase()))),this.filterStatus&&(t=t.filter(n=>n.status===this.filterStatus)),this.filterUser&&(t=t.filter(n=>this.userIdToName[n.userId]===this.filterUser)),this.filterDate&&(t=t.filter(n=>n.orderDate.startsWith(this.filterDate))),this.filteredOrders=t,this.totalPages=Math.ceil(this.filteredOrders.length/this.pageSize)||1,this.page>this.totalPages&&(this.page=this.totalPages)}get pagedOrders(){const t=(this.page-1)*this.pageSize;return this.filteredOrders.slice(t,t+this.pageSize)}setPage(t){t>=1&&t<=this.totalPages&&(this.page=t)}markAsDelivered(t){this.isUpdating=t,this.ordersService.updateOrderStatus(t,"delivered").subscribe({next:()=>{this.notificationService.show("Order marked as delivered!","success"),this.loadOrders(),this.isUpdating=null},error:()=>{this.notificationService.show("Failed to update order status.","error"),this.isUpdating=null}})}viewOrderDetail(t){this.router.navigate(["/admin/orders",t])}static{this.\u0275fac=function(n){return new(n||s)(e.rXU(p.B),e.rXU(g.J),e.rXU(h.Ix),e.rXU(u.u))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-admin-orders"]],standalone:!0,features:[e.aNF],decls:33,vars:7,consts:[[1,"admin-orders-controls"],["type","text","placeholder","Search Order ID or User ID",1,"filter-input",3,"ngModel","ngModelChange","input"],[1,"filter-select",3,"ngModel","ngModelChange","change"],["value",""],["value","pending"],["value","delivered"],["value","cancelled"],[3,"value",4,"ngFor","ngForOf"],["type","date",1,"filter-input",3,"ngModel","ngModelChange","change"],[1,"table-responsive"],[1,"admin-table"],[4,"ngFor","ngForOf"],["class","pagination-controls",4,"ngIf"],[3,"value"],[2,"color","#d02653","cursor","pointer","text-decoration","underline",3,"click"],[1,"pagination-controls"],[3,"disabled","click"],[3,"click"]],template:function(n,r){1&n&&(e.j41(0,"div",0)(1,"input",1),e.bIt("ngModelChange",function(o){return r.searchTerm=o})("input",function(){return r.applyFilters()}),e.k0s(),e.j41(2,"select",2),e.bIt("ngModelChange",function(o){return r.filterStatus=o})("change",function(){return r.applyFilters()}),e.j41(3,"option",3),e.EFF(4,"All Statuses"),e.k0s(),e.j41(5,"option",4),e.EFF(6,"Pending"),e.k0s(),e.j41(7,"option",5),e.EFF(8,"Delivered"),e.k0s(),e.j41(9,"option",6),e.EFF(10,"Cancelled"),e.k0s()(),e.j41(11,"select",2),e.bIt("ngModelChange",function(o){return r.filterUser=o})("change",function(){return r.applyFilters()}),e.j41(12,"option",3),e.EFF(13,"All Users"),e.k0s(),e.DNE(14,m,2,2,"option",7),e.k0s(),e.j41(15,"input",8),e.bIt("ngModelChange",function(o){return r.filterDate=o})("change",function(){return r.applyFilters()}),e.k0s()(),e.j41(16,"div",9)(17,"table",10)(18,"thead")(19,"tr")(20,"th"),e.EFF(21,"Order ID"),e.k0s(),e.j41(22,"th"),e.EFF(23,"User Name"),e.k0s(),e.j41(24,"th"),e.EFF(25,"Status"),e.k0s(),e.j41(26,"th"),e.EFF(27,"Total"),e.k0s(),e.j41(28,"th"),e.EFF(29,"Date"),e.k0s()()(),e.j41(30,"tbody"),e.DNE(31,f,14,11,"tr",11),e.k0s()()(),e.DNE(32,M,6,4,"div",12)),2&n&&(e.R7$(1),e.Y8G("ngModel",r.searchTerm),e.R7$(1),e.Y8G("ngModel",r.filterStatus),e.R7$(9),e.Y8G("ngModel",r.filterUser),e.R7$(3),e.Y8G("ngForOf",r.userNames),e.R7$(1),e.Y8G("ngModel",r.filterDate),e.R7$(16),e.Y8G("ngForOf",r.pagedOrders),e.R7$(1),e.Y8G("ngIf",r.totalPages>1))},dependencies:[c.MD,c.Sq,c.bT,c.oe,c.vh,d.YN,d.xH,d.y7,d.me,d.wz,d.BC,d.vS],styles:[".admin-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:24px}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #f0f0f0;padding:10px 12px;text-align:left}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#d02653;color:#fff;font-weight:600}.admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#fafbfc}.admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#ffe6ea}.admin-orders-controls[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:18px}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{padding:7px 10px;border:1px solid #ddd;border-radius:5px;font-size:1rem;min-width:120px}.table-responsive[_ngcontent-%COMP%]{width:100%;overflow-x:auto}.pagination-controls[_ngcontent-%COMP%]{display:flex;gap:4px;justify-content:center;margin:18px 0 0}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff;border:1px solid #d02653;color:#d02653;border-radius:4px;padding:4px 12px;font-size:1rem;cursor:pointer;margin:0 2px;transition:background .2s,color .2s}.pagination-controls[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%], .pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#d02653;color:#fff}@media (max-width: 700px){.admin-orders-controls[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{width:100%;min-width:0}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:7px 6px;font-size:.97rem}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.95rem;padding:3px 8px}}"]})}}return s})()}}]);
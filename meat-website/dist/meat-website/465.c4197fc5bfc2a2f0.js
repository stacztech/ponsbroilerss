"use strict";(self.webpackChunkmeat_website=self.webpackChunkmeat_website||[]).push([[465],{7465:(le,g,d)=>{d.r(g),d.d(g,{ProfileComponent:()=>se});var f=d(177),m=d(2522),a=d(8326),h=d(7258),w=d(5254),p=d(7605),e=d(5345),C=d(6868),x=d(7519),v=d(4796),l=d(4421);let b=(()=>{class r{constructor(t){this.authService=t,this.reviews=[],this.loadReviews()}loadReviews(){const t=this.authService.getCurrentUser();if(!t)return;const i=localStorage.getItem(`reviews_${t.id}`);i&&(this.reviews=JSON.parse(i))}saveReviews(){const t=this.authService.getCurrentUser();t&&localStorage.setItem(`reviews_${t.id}`,JSON.stringify(this.reviews))}submitReview(t){const i=this.authService.getCurrentUser();if(!i)throw new Error("User must be logged in to submit a review");const n={id:"REV"+Date.now()+Math.random().toString(36).substr(2,9),userId:i.id,date:(new Date).toISOString(),...t};return this.reviews.unshift(n),this.saveReviews(),(0,l.of)(n)}getReviewsByUserId(t){return this.loadReviews(),(0,l.of)(this.reviews.filter(i=>i.userId===t))}getReviewById(t){return this.loadReviews(),(0,l.of)(this.reviews.find(i=>i.id===t))}updateReview(t,i){const n=this.authService.getCurrentUser();if(!n)return(0,l.of)(!1);const s=this.reviews.findIndex(c=>c.id===t&&c.userId===n.id);return-1===s?(0,l.of)(!1):(this.reviews[s]={...this.reviews[s],...i,date:(new Date).toISOString()},this.saveReviews(),(0,l.of)(!0))}deleteReview(t){const i=this.authService.getCurrentUser();if(!i)return(0,l.of)(!1);const n=this.reviews.length;return this.reviews=this.reviews.filter(s=>s.id!==t||s.userId!==i.id),this.reviews.length<n?(this.saveReviews(),(0,l.of)(!0)):(0,l.of)(!1)}static{this.\u0275fac=function(i){return new(i||r)(e.KVO(v.u))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var F=d(7473);function P(r,o){1&r&&(e.j41(0,"div",24)(1,"div",25)(2,"span",26),e.EFF(3,"Loading..."),e.k0s()()())}function k(r,o){if(1&r&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.errorMessage," ")}}function R(r,o){1&r&&(e.j41(0,"div",28)(1,"p"),e.EFF(2,"You haven't placed any orders yet."),e.k0s(),e.j41(3,"a",29),e.EFF(4,"Start Shopping"),e.k0s()())}function O(r,o){if(1&r&&(e.j41(0,"div",44)(1,"span"),e.EFF(2),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s(),e.j41(5,"span"),e.EFF(6),e.k0s()()),2&r){const t=o.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.SpI("",t.quantity,"x"),e.R7$(2),e.SpI("\u20b9",t.price,"")}}function M(r,o){if(1&r){const t=e.RV6();e.j41(0,"button",45),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(3);return e.Njj(s.writeReview(n))}),e.EFF(1),e.k0s()}if(2&r){const t=e.XpG().$implicit,i=e.XpG(3);e.R7$(1),e.SpI(" ",i.getReviewButtonText(t.id)," ")}}function E(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",32)(1,"div",33)(2,"div",34),e.EFF(3),e.k0s(),e.j41(4,"div",35),e.EFF(5),e.nI1(6,"date"),e.k0s(),e.j41(7,"div",36),e.EFF(8),e.k0s()(),e.j41(9,"div",37),e.DNE(10,O,7,3,"div",38),e.k0s(),e.j41(11,"div",39)(12,"div",40),e.EFF(13),e.k0s(),e.j41(14,"div",41)(15,"button",42),e.bIt("click",function(){const s=e.eBV(t).$implicit,c=e.XpG(3);return e.Njj(c.reorder(s))}),e.EFF(16,"Reorder"),e.k0s(),e.DNE(17,M,2,1,"button",43),e.k0s()()()}if(2&r){const t=o.$implicit;e.R7$(3),e.SpI("Order #",t.id,""),e.R7$(2),e.SpI("Expected Delivery: ",e.i5U(6,7,t.expectedDeliveryDate,"mediumDate"),""),e.R7$(2),e.Y8G("ngClass",t.status.toLowerCase()),e.R7$(1),e.SpI(" ",t.status," "),e.R7$(2),e.Y8G("ngForOf",t.items),e.R7$(3),e.SpI("Total: \u20b9",t.total,""),e.R7$(4),e.Y8G("ngIf","delivered"===t.status)}}function j(r,o){if(1&r&&(e.j41(0,"div",30),e.DNE(1,E,18,10,"div",31),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.orders)}}function I(r,o){if(1&r&&(e.j41(0,"div",19)(1,"h3"),e.EFF(2,"My Orders"),e.k0s(),e.DNE(3,P,4,0,"div",20),e.DNE(4,k,2,1,"div",21),e.DNE(5,R,5,0,"div",22),e.DNE(6,j,2,1,"div",23),e.k0s()),2&r){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",t.isLoading),e.R7$(1),e.Y8G("ngIf",t.errorMessage),e.R7$(1),e.Y8G("ngIf",!t.isLoading&&0===t.orders.length),e.R7$(1),e.Y8G("ngIf",!t.isLoading&&t.orders.length>0)}}function y(r,o){1&r&&(e.j41(0,"div",50),e.EFF(1,"No reviews yet."),e.k0s())}const u=function(r){return{filled:r}};function S(r,o){if(1&r&&(e.j41(0,"span",61),e.nrm(1,"i",62),e.k0s()),2&r){const t=o.$implicit,i=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(1,u,t<=i.rating))}}const _=function(){return[1,2,3,4,5]};function $(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",51)(1,"div",52)(2,"div",53),e.EFF(3),e.k0s(),e.j41(4,"div",54),e.EFF(5),e.nI1(6,"date"),e.k0s()(),e.j41(7,"div",55),e.DNE(8,S,2,3,"span",56),e.k0s(),e.j41(9,"div",57)(10,"p"),e.EFF(11),e.k0s()(),e.j41(12,"div",58)(13,"button",59),e.bIt("click",function(){const s=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.editReview(s))}),e.EFF(14,"Edit Review"),e.k0s(),e.j41(15,"button",60),e.bIt("click",function(){const s=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.deleteReview(s))}),e.EFF(16,"Delete Review"),e.k0s()()()}if(2&r){const t=o.$implicit;e.R7$(3),e.SpI("Order #",t.orderId,""),e.R7$(2),e.JRh(e.i5U(6,4,t.date,"mediumDate")),e.R7$(3),e.Y8G("ngForOf",e.lJ4(7,_)),e.R7$(3),e.JRh(t.comment)}}function G(r,o){if(1&r&&(e.j41(0,"div",46)(1,"h3"),e.EFF(2,"Order Reviews"),e.k0s(),e.DNE(3,y,2,0,"div",47),e.j41(4,"div",48),e.DNE(5,$,17,8,"div",49),e.k0s()()),2&r){const t=e.XpG();e.R7$(3),e.Y8G("ngIf",0===t.reviews.length),e.R7$(2),e.Y8G("ngForOf",t.reviews)}}function N(r,o){1&r&&(e.j41(0,"div",63)(1,"h3"),e.EFF(2,"My Addresses"),e.k0s(),e.nrm(3,"app-delivery-address",64),e.k0s()),2&r&&(e.R7$(3),e.Y8G("showOrderSummary",!1))}function D(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Name is required "),e.k0s())}function T(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Please enter a valid email "),e.k0s())}function Y(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Please enter a valid 10-digit phone number "),e.k0s())}function X(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",65)(1,"h3"),e.EFF(2,"Personal Information"),e.k0s(),e.j41(3,"form",66),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.savePersonalInfo())}),e.j41(4,"div",67)(5,"label"),e.EFF(6,"Full Name"),e.k0s(),e.nrm(7,"input",68),e.DNE(8,D,2,0,"div",69),e.k0s(),e.j41(9,"div",67)(10,"label"),e.EFF(11,"Email"),e.k0s(),e.nrm(12,"input",70),e.DNE(13,T,2,0,"div",69),e.k0s(),e.j41(14,"div",67)(15,"label"),e.EFF(16,"Phone"),e.k0s(),e.nrm(17,"input",71),e.DNE(18,Y,2,0,"div",69),e.k0s(),e.j41(19,"div",67)(20,"label"),e.EFF(21,"Date of Birth"),e.k0s(),e.nrm(22,"input",72),e.k0s(),e.j41(23,"button",73),e.EFF(24,"Save Changes"),e.k0s()()()}if(2&r){const t=e.XpG();e.R7$(3),e.Y8G("formGroup",t.profileForm),e.R7$(5),e.Y8G("ngIf",t.profileFormControls.name.invalid&&t.profileFormControls.name.touched),e.R7$(5),e.Y8G("ngIf",t.profileFormControls.email.invalid&&t.profileFormControls.email.touched),e.R7$(5),e.Y8G("ngIf",t.profileFormControls.phone.invalid&&t.profileFormControls.phone.touched),e.R7$(5),e.Y8G("disabled",t.profileForm.invalid)}}function L(r,o){if(1&r&&(e.j41(0,"div",85),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.JRh(t.resetLinkMessage)}}function V(r,o){if(1&r&&(e.j41(0,"div",74),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.JRh(t.resetLinkError)}}function U(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Current password is required "),e.k0s())}function z(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Password must be at least 6 characters "),e.k0s())}function B(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Passwords do not match "),e.k0s())}function A(r,o){if(1&r&&(e.j41(0,"div",74),e.EFF(1),e.k0s()),2&r){const t=e.XpG(3);e.R7$(1),e.JRh(t.passwordError)}}function J(r,o){if(1&r&&(e.j41(0,"div",85),e.EFF(1),e.k0s()),2&r){const t=e.XpG(3);e.R7$(1),e.JRh(t.passwordSuccess)}}function Q(r,o){if(1&r){const t=e.RV6();e.j41(0,"form",86),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.changePassword())}),e.j41(1,"div",67),e.nrm(2,"input",87),e.DNE(3,U,2,0,"div",69),e.k0s(),e.j41(4,"div",67),e.nrm(5,"input",88),e.DNE(6,z,2,0,"div",69),e.k0s(),e.j41(7,"div",67),e.nrm(8,"input",89),e.DNE(9,B,2,0,"div",69),e.k0s(),e.j41(10,"button",73),e.EFF(11,"Save Password"),e.k0s(),e.DNE(12,A,2,1,"div",69),e.DNE(13,J,2,1,"div",79),e.k0s()}if(2&r){const t=e.XpG(2);e.Y8G("formGroup",t.passwordForm),e.R7$(3),e.Y8G("ngIf",t.passwordFormControls.currentPassword.invalid&&t.passwordFormControls.currentPassword.touched),e.R7$(3),e.Y8G("ngIf",t.passwordFormControls.newPassword.invalid&&t.passwordFormControls.newPassword.touched),e.R7$(3),e.Y8G("ngIf",t.passwordFormControls.confirmNewPassword.invalid&&t.passwordFormControls.confirmNewPassword.touched),e.R7$(1),e.Y8G("disabled",t.passwordForm.invalid),e.R7$(2),e.Y8G("ngIf",t.passwordError),e.R7$(1),e.Y8G("ngIf",t.passwordSuccess)}}function q(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",75)(1,"h3"),e.EFF(2,"Account Settings"),e.k0s(),e.j41(3,"div",76)(4,"div",77)(5,"h4"),e.EFF(6,"Password"),e.k0s(),e.j41(7,"button",78),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.sendPasswordResetLink())}),e.EFF(8,"Send Password Reset Link"),e.k0s(),e.DNE(9,L,2,1,"div",79),e.DNE(10,V,2,1,"div",69),e.DNE(11,Q,14,7,"form",80),e.k0s(),e.j41(12,"div",77)(13,"h4"),e.EFF(14,"Notifications"),e.k0s(),e.j41(15,"div",81)(16,"label",82)(17,"input",83),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.settings.emailNotifications=n)}),e.k0s(),e.nrm(18,"span",84),e.EFF(19," Email Notifications "),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(9),e.Y8G("ngIf",t.resetLinkMessage),e.R7$(1),e.Y8G("ngIf",t.resetLinkError),e.R7$(1),e.Y8G("ngIf",t.showPasswordForm),e.R7$(6),e.Y8G("ngModel",t.settings.emailNotifications)}}function W(r,o){if(1&r&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.errorMessage," ")}}function K(r,o){if(1&r){const t=e.RV6();e.j41(0,"span",100),e.bIt("click",function(){const s=e.eBV(t).$implicit,c=e.XpG(2);return e.Njj(c.reviewFormControls.rating.setValue(s))}),e.nrm(1,"i",62),e.k0s()}if(2&r){const t=o.$implicit,i=e.XpG(2);e.Y8G("ngClass",e.eq3(1,u,t<=i.reviewFormControls.rating.value))}}function H(r,o){1&r&&(e.j41(0,"div",74),e.EFF(1," Please select a rating "),e.k0s())}function Z(r,o){1&r&&(e.j41(0,"span"),e.EFF(1,"Comment is required"),e.k0s())}function ee(r,o){1&r&&(e.j41(0,"span"),e.EFF(1,"Comment must be at least 10 characters"),e.k0s())}function te(r,o){if(1&r&&(e.j41(0,"div",74),e.DNE(1,Z,2,0,"span",97),e.DNE(2,ee,2,0,"span",97),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.Y8G("ngIf",null==t.reviewFormControls.comment.errors?null:t.reviewFormControls.comment.errors.required),e.R7$(1),e.Y8G("ngIf",null==t.reviewFormControls.comment.errors?null:t.reviewFormControls.comment.errors.minlength)}}function re(r,o){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(1),e.JRh(t.editingReview?"Update Review":"Submit Review")}}function ie(r,o){1&r&&e.nrm(0,"span",101)}const ne=function(r){return{"is-invalid":r}};function oe(r,o){if(1&r){const t=e.RV6();e.j41(0,"div",90),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelReviewForm())}),e.j41(1,"div",91),e.bIt("click",function(n){return n.stopPropagation()}),e.j41(2,"h4"),e.EFF(3),e.k0s(),e.DNE(4,W,2,1,"div",21),e.j41(5,"form",92),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.submitReviewForm())}),e.j41(6,"div",67)(7,"label"),e.EFF(8,"Rating:"),e.k0s(),e.j41(9,"div",93),e.DNE(10,K,2,3,"span",94),e.k0s(),e.DNE(11,H,2,0,"div",69),e.k0s(),e.j41(12,"div",67)(13,"label"),e.EFF(14,"Comment:"),e.k0s(),e.j41(15,"textarea",95),e.EFF(16,"        "),e.k0s(),e.DNE(17,te,3,2,"div",69),e.k0s(),e.j41(18,"div",96)(19,"button",73),e.DNE(20,re,2,1,"span",97),e.DNE(21,ie,1,0,"span",98),e.k0s(),e.j41(22,"button",99),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.cancelReviewForm())}),e.EFF(23," Cancel "),e.k0s()()()()()}if(2&r){const t=e.XpG();e.R7$(3),e.Lme("",t.editingReview?"Edit Review":"Write a Review"," for Order #",null==t.currentOrderForReview?null:t.currentOrderForReview.id,""),e.R7$(1),e.Y8G("ngIf",t.errorMessage),e.R7$(1),e.Y8G("formGroup",t.reviewForm),e.R7$(5),e.Y8G("ngForOf",e.lJ4(12,_)),e.R7$(1),e.Y8G("ngIf",t.reviewFormControls.rating.invalid&&t.reviewFormControls.rating.touched),e.R7$(4),e.Y8G("ngClass",e.eq3(13,ne,t.reviewFormControls.comment.invalid&&t.reviewFormControls.comment.touched)),e.R7$(2),e.Y8G("ngIf",t.reviewFormControls.comment.invalid&&t.reviewFormControls.comment.touched),e.R7$(2),e.Y8G("disabled",t.reviewForm.invalid||t.isLoading),e.R7$(1),e.Y8G("ngIf",!t.isLoading),e.R7$(1),e.Y8G("ngIf",t.isLoading),e.R7$(1),e.Y8G("disabled",t.isLoading)}}let se=(()=>{class r{constructor(t,i,n,s,c,ae,de,ce){this.router=t,this.cartService=i,this.ordersService=n,this.authService=s,this.reviewService=c,this.fb=ae,this.route=de,this.notificationService=ce,this.destroy$=new w.B7,this.activeSection="orders",this.user={id:"",name:"",email:"",addresses:[],joinDate:(new Date).toISOString()},this.orders=[],this.reviews=[],this.addresses=[],this.settings={emailNotifications:!0,smsNotifications:!1},this.showPasswordForm=!1,this.passwordError="",this.passwordSuccess="",this.showReviewForm=!1,this.editingReview=!1,this.currentReviewId=null,this.currentOrderForReview=null,this.isLoading=!1,this.errorMessage="",this.resetLinkMessage="",this.resetLinkError="",this.initializeForms()}initializeForms(){this.passwordForm=this.fb.group({currentPassword:["",[a.k0.required,a.k0.minLength(6)]],newPassword:["",[a.k0.required,a.k0.minLength(6)]],confirmNewPassword:["",[a.k0.required]]},{validator:this.passwordMatchValidator}),this.profileForm=this.fb.group({name:["",a.k0.required],email:["",[a.k0.required,a.k0.email]],phone:["",[a.k0.pattern("^[0-9]{10}$")]],address:[""],dob:[""],joinDate:[""]}),this.reviewForm=this.fb.group({rating:[0,[a.k0.required,a.k0.min(1),a.k0.max(5)]],comment:["",[a.k0.required,a.k0.minLength(10)]]})}passwordMatchValidator(t){return t.get("newPassword")?.value===t.get("confirmNewPassword")?.value?null:{mismatch:!0}}ngOnInit(){this.loadUserData(),this.loadOrders(),this.loadReviews(),this.loadAddresses(),this.route.queryParams.subscribe(t=>{const i=t.reviewOrderId;if(i&&this.orders.length>0){const n=this.orders.find(s=>s.id===i);n&&"delivered"===n.status&&this.writeReview(n)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadUserData(){const t=this.authService.getCurrentUser();if(t){const i={...t,joinDate:t.joinDate||(new Date).toISOString(),dob:t.dob||""};this.user=i,this.profileForm.patchValue({name:t.name,email:t.email,phone:t.phone||"",address:t.address||"",dob:i.dob,joinDate:i.joinDate})}}loadOrders(){this.isLoading=!0;try{this.ordersService.getOrders().subscribe(t=>{this.orders=this.processOrders(t.orders),this.isLoading=!1})}catch(t){this.errorMessage="Failed to load orders. Please try again later.",this.isLoading=!1,console.error("Error loading orders:",t)}}processOrders(t){const i=new Date;return t.map(n=>{const s={...n,expectedDeliveryDate:n.expectedDeliveryDate||(new Date).toISOString()};return s.expectedDeliveryDate&&new Date(s.expectedDeliveryDate)<i&&"delivered"!==s.status&&(this.ordersService.updateOrderStatus(s.id,"delivered").subscribe({next:()=>{this.loadOrders()},error:c=>{console.error("Error updating order status:",c)}}),s.status="delivered"),s})}loadReviews(){const t=this.authService.getCurrentUser();t&&this.reviewService.getReviewsByUserId(t.id).pipe((0,p.Q)(this.destroy$)).subscribe({next:i=>this.reviews=i,error:i=>{this.errorMessage="Failed to load reviews. Please try again later.",console.error("Error loading reviews:",i)}})}loadAddresses(){}reorder(t){try{console.log("Reordering order:",t),this.router.navigate(["/checkout"],{state:{cartItems:t.items,paymentMethod:t.paymentMethod,total:t.total}}).then(i=>{i||this.notificationService.show("Failed to redirect to checkout. Please try again.","error")})}catch(i){this.notificationService.show("Failed to redirect to checkout. Please try again.","error"),console.error("Reorder navigation error:",i)}}writeReview(t){if("delivered"!==t.status)return void(this.errorMessage="You can only review delivered orders.");const i=this.reviews.find(n=>n.orderId===t.id);i?this.editReview(i):(this.currentOrderForReview=t,this.editingReview=!1,this.currentReviewId=null,this.reviewForm.reset({rating:0,comment:""}),this.showReviewForm=!0)}editReview(t){this.editingReview=!0,this.currentReviewId=t.id,this.currentOrderForReview=this.orders.find(i=>i.id===t.orderId)||null,this.currentOrderForReview?(this.reviewForm.patchValue({rating:t.rating,comment:t.comment}),this.showReviewForm=!0):this.errorMessage="Order not found."}deleteReview(t){confirm("Are you sure you want to delete this review?")&&this.reviewService.deleteReview(t.id).pipe((0,p.Q)(this.destroy$)).subscribe({next:i=>{i?(this.loadReviews(),this.notificationService.show("Review deleted successfully!","success")):(this.errorMessage="Failed to delete review. Please try again.",this.notificationService.show("Failed to delete review.","error"))},error:i=>{this.errorMessage="Failed to delete review. Please try again later.",this.notificationService.show("Failed to delete review.","error"),console.error("Error deleting review:",i)}})}submitReviewForm(){if(this.reviewForm.invalid||!this.currentOrderForReview)return void this.reviewForm.markAllAsTouched();const t={...this.reviewForm.value,orderId:this.currentOrderForReview.id,userId:this.user.id,date:(new Date).toISOString()};this.editingReview&&this.currentReviewId?this.reviewService.updateReview(this.currentReviewId,t).pipe((0,p.Q)(this.destroy$)).subscribe({next:i=>{i?(this.loadReviews(),this.cancelReviewForm(),this.errorMessage="",this.notificationService.show("Review updated successfully!","success")):(this.errorMessage="Failed to update review. Please try again.",this.notificationService.show("Failed to update review.","error"))},error:i=>{this.errorMessage="Failed to update review. Please try again later.",this.notificationService.show("Failed to update review.","error"),console.error("Error updating review:",i)}}):this.reviewService.submitReview(t).pipe((0,p.Q)(this.destroy$)).subscribe({next:()=>{this.loadReviews(),this.cancelReviewForm(),this.errorMessage="",this.notificationService.show("Review submitted successfully!","success")},error:i=>{this.errorMessage="Failed to submit review. Please try again later.",this.notificationService.show("Failed to submit review.","error"),console.error("Error submitting review:",i)}})}cancelReviewForm(){this.showReviewForm=!1,this.editingReview=!1,this.currentReviewId=null,this.currentOrderForReview=null,this.reviewForm.reset({rating:0,comment:""}),this.errorMessage=""}savePersonalInfo(){if(this.profileForm.invalid)return void this.profileForm.markAllAsTouched();const t=this.profileForm.value;this.authService.updateProfile(t).pipe((0,p.Q)(this.destroy$)).subscribe({next:i=>{this.user={...this.user,...t},this.errorMessage=""},error:i=>{this.errorMessage=i.message||"Failed to update profile. Please try again.",console.error("Error updating profile:",i)}})}changePassword(){this.passwordForm.invalid?this.passwordForm.markAllAsTouched():(this.passwordError="",this.passwordSuccess="")}get passwordFormControls(){return this.passwordForm.controls}get profileFormControls(){return this.profileForm.controls}get reviewFormControls(){return this.reviewForm.controls}hasReview(t){return this.reviews.some(i=>i.orderId===t)}getReviewButtonText(t){return this.hasReview(t)?"Edit Review":"Write Review"}getReviewForOrder(t){return this.reviews.find(i=>i.orderId===t)}sendPasswordResetLink(){this.resetLinkMessage="",this.resetLinkError="",this.user.email?this.authService.sendPasswordResetEmail(this.user.email).pipe((0,p.Q)(this.destroy$)).subscribe({next:()=>{this.resetLinkMessage="Password reset link has been sent to your email address."},error:t=>{this.resetLinkError=t.message||"Failed to send reset link. Please try again."}}):this.resetLinkError="No email found for your account."}static{this.\u0275fac=function(i){return new(i||r)(e.rXU(m.Ix),e.rXU(C.m),e.rXU(x.B),e.rXU(v.u),e.rXU(b),e.rXU(a.ok),e.rXU(m.nX),e.rXU(F.J))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-profile"]],standalone:!0,features:[e.aNF],decls:35,vars:19,consts:[[1,"profile-container"],[1,"profile-header"],[1,"user-info"],[1,"user-details"],[1,"profile-content"],[1,"profile-nav"],[3,"click"],[1,"bi","bi-box-seam"],[1,"bi","bi-geo-alt"],[1,"bi","bi-person"],[1,"bi","bi-gear"],[1,"bi","bi-star"],[1,"content-area"],["class","orders-section",4,"ngIf"],["class","reviews-section",4,"ngIf"],["class","addresses-section",4,"ngIf"],["class","personal-section",4,"ngIf"],["class","settings-section",4,"ngIf"],["class","review-form-overlay",3,"click",4,"ngIf"],[1,"orders-section"],["class","text-center",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","no-orders",4,"ngIf"],["class","orders-list",4,"ngIf"],[1,"text-center"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"alert","alert-danger"],[1,"no-orders"],["routerLink","/chicken",1,"btn","btn-primary"],[1,"orders-list"],["class","order-card",4,"ngFor","ngForOf"],[1,"order-card"],[1,"order-header"],[1,"order-id"],[1,"order-date"],[1,"order-status",3,"ngClass"],[1,"order-items"],["class","order-item",4,"ngFor","ngForOf"],[1,"order-footer"],[1,"order-total"],[1,"order-actions"],[1,"btn-reorder",3,"click"],["class","btn-review",3,"click",4,"ngIf"],[1,"order-item"],[1,"btn-review",3,"click"],[1,"reviews-section"],["class","no-reviews",4,"ngIf"],[1,"reviews-list"],["class","review-card",4,"ngFor","ngForOf"],[1,"no-reviews"],[1,"review-card"],[1,"review-header"],[1,"review-order"],[1,"review-date"],[1,"review-rating"],["class","star",3,"ngClass",4,"ngFor","ngForOf"],[1,"review-content"],[1,"review-actions"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click"],[1,"star",3,"ngClass"],[1,"bi","bi-star-fill"],[1,"addresses-section"],[3,"showOrderSummary"],[1,"personal-section"],[1,"personal-form",3,"formGroup","ngSubmit"],[1,"form-group"],["type","text","formControlName","name"],["class","text-danger",4,"ngIf"],["type","email","formControlName","email"],["type","tel","formControlName","phone"],["type","date","formControlName","dob"],["type","submit",1,"btn-save",3,"disabled"],[1,"text-danger"],[1,"settings-section"],[1,"settings-list"],[1,"setting-item"],["type","button",1,"btn-change",3,"click"],["class","text-success",4,"ngIf"],["class","password-form",3,"formGroup","ngSubmit",4,"ngIf"],[1,"notification-settings"],[1,"toggle"],["type","checkbox","name","emailNotifications",3,"ngModel","ngModelChange"],[1,"slider"],[1,"text-success"],[1,"password-form",3,"formGroup","ngSubmit"],["type","password","formControlName","currentPassword","placeholder","Current Password"],["type","password","formControlName","newPassword","placeholder","New Password"],["type","password","formControlName","confirmNewPassword","placeholder","Confirm New Password"],[1,"review-form-overlay",3,"click"],[1,"review-form-container",3,"click"],[3,"formGroup","ngSubmit"],[1,"star-rating"],["class","star",3,"ngClass","click",4,"ngFor","ngForOf"],["formControlName","comment","rows","4","placeholder","Share your experience with this order...",3,"ngClass"],[1,"form-actions"],[4,"ngIf"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],["type","button",1,"btn-cancel",3,"disabled","click"],[1,"star",3,"ngClass","click"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(i,n){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),e.EFF(5),e.k0s(),e.j41(6,"p"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s()()()(),e.j41(10,"div",4)(11,"div",5)(12,"ul")(13,"li",6),e.bIt("click",function(){return n.activeSection="orders"}),e.nrm(14,"i",7),e.EFF(15," My Orders "),e.k0s(),e.j41(16,"li",6),e.bIt("click",function(){return n.activeSection="addresses"}),e.nrm(17,"i",8),e.EFF(18," Addresses "),e.k0s(),e.j41(19,"li",6),e.bIt("click",function(){return n.activeSection="personal"}),e.nrm(20,"i",9),e.EFF(21," Personal Information "),e.k0s(),e.j41(22,"li",6),e.bIt("click",function(){return n.activeSection="settings"}),e.nrm(23,"i",10),e.EFF(24," Account Settings "),e.k0s(),e.j41(25,"li",6),e.bIt("click",function(){return n.activeSection="reviews"}),e.nrm(26,"i",11),e.EFF(27," Order Reviews "),e.k0s()()(),e.j41(28,"div",12),e.DNE(29,I,7,4,"div",13),e.DNE(30,G,6,2,"div",14),e.DNE(31,N,4,1,"div",15),e.DNE(32,X,25,5,"div",16),e.DNE(33,q,20,4,"div",17),e.k0s()()(),e.DNE(34,oe,24,15,"div",18)),2&i&&(e.R7$(5),e.JRh(n.user.name),e.R7$(2),e.JRh(n.user.email),e.R7$(2),e.SpI("Member since ",n.user.joinDate,""),e.R7$(4),e.AVh("active","orders"===n.activeSection),e.R7$(3),e.AVh("active","addresses"===n.activeSection),e.R7$(3),e.AVh("active","personal"===n.activeSection),e.R7$(3),e.AVh("active","settings"===n.activeSection),e.R7$(3),e.AVh("active","reviews"===n.activeSection),e.R7$(4),e.Y8G("ngIf","orders"===n.activeSection),e.R7$(1),e.Y8G("ngIf","reviews"===n.activeSection),e.R7$(1),e.Y8G("ngIf","addresses"===n.activeSection),e.R7$(1),e.Y8G("ngIf","personal"===n.activeSection),e.R7$(1),e.Y8G("ngIf","settings"===n.activeSection),e.R7$(1),e.Y8G("ngIf",n.showReviewForm))},dependencies:[f.MD,f.YU,f.Sq,f.bT,f.vh,m.iI,m.Wk,a.YN,a.qT,a.me,a.Zm,a.BC,a.cb,a.vS,a.X1,a.j4,a.JD,h.K],styles:['.profile-container[_ngcontent-%COMP%]{max-width:1100px;margin:32px auto;background:#fff;border-radius:12px;box-shadow:0 4px 24px #00000012;padding:0 0 32px;min-height:600px}.profile-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#faf8f8 0%,#dd5f81 100%);border-radius:12px 12px 0 0;padding:32px 32px 24px;color:#fff;display:flex;align-items:center;min-height:120px}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center}.user-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 6px;font-size:2rem;font-weight:600;color:#1a1a1a}.user-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem;opacity:.95;color:#2c3e50}.profile-content[_ngcontent-%COMP%]{display:flex;gap:32px;padding:32px}.profile-nav[_ngcontent-%COMP%]{min-width:210px;border-right:1px solid #f0f0f0;padding-right:24px}.profile-nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.profile-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:12px 16px;margin-bottom:8px;border-radius:6px;cursor:pointer;font-size:1rem;color:#2c3e50;display:flex;align-items:center;gap:10px;transition:background .2s,color .2s}.profile-nav[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%], .profile-nav[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#E31837;color:#fff}.profile-nav[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.content-area[_ngcontent-%COMP%]{flex:1;min-width:0}.orders-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .reviews-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .addresses-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .personal-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .settings-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:600;margin-bottom:18px;color:#e31837}.no-orders[_ngcontent-%COMP%]{text-align:center;color:#888;padding:32px 0}.orders-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px}.order-card[_ngcontent-%COMP%]{background:#fafbfc;border:1px solid #f0f0f0;border-radius:8px;padding:18px 20px;box-shadow:0 2px 8px #00000008}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;flex-wrap:wrap;gap:8px}.order-id[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.order-date[_ngcontent-%COMP%]{font-size:.95rem;color:#888}.order-status[_ngcontent-%COMP%]{padding:2px 10px;border-radius:12px;font-size:.95rem;font-weight:500;text-transform:capitalize;background:#f0f0f0;color:#2c3e50}.order-status.delivered[_ngcontent-%COMP%]{background:#e8f5e9;color:#00a642}.order-status.pending[_ngcontent-%COMP%]{background:#fff3cd;color:#f8b500}.order-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;margin-bottom:10px}.order-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1rem;color:#444}.order-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:8px}.order-total[_ngcontent-%COMP%]{font-weight:600;color:#e31837}.order-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.btn-reorder[_ngcontent-%COMP%], .btn-review[_ngcontent-%COMP%]{background:#E31837;color:#fff;border:none;border-radius:4px;padding:6px 14px;font-size:.98rem;cursor:pointer;transition:background .2s}.btn-review[_ngcontent-%COMP%]{background:#f8b500;color:#fff}.btn-reorder[_ngcontent-%COMP%]:hover, .btn-review[_ngcontent-%COMP%]:hover{opacity:.9}.reviews-section[_ngcontent-%COMP%]{position:relative}.no-reviews[_ngcontent-%COMP%]{text-align:center;color:#666;padding:20px;border:1px dashed #f0f0f0;border-radius:8px;margin-top:20px}.reviews-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px;margin-top:12px}.review-card[_ngcontent-%COMP%]{border:1px solid #f0f0f0;border-radius:8px;padding:15px;margin-bottom:0;background:#fff;box-shadow:0 2px 8px #00000008}.review-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:10px}.review-rating[_ngcontent-%COMP%]{margin:10px 0}.star-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%], .review-rating[_ngcontent-%COMP%]   .star[_ngcontent-%COMP%]{font-size:1.5rem;cursor:pointer}.star[_ngcontent-%COMP%]{color:#ddd;margin-right:2px}.star.filled[_ngcontent-%COMP%]{color:#f8b500}.review-content[_ngcontent-%COMP%]{margin:10px 0}.review-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%]{background:#f0f0f0;color:#2c3e50;border:none;border-radius:4px;padding:5px 12px;font-size:.97rem;cursor:pointer;transition:background .2s}.btn-edit[_ngcontent-%COMP%]:hover{background:#f8b500;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover{background:#E31837;color:#fff}.review-form-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:1000}.review-form-container[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:10px;box-shadow:0 4px 20px #0003;width:90%;max-width:500px;position:relative}.review-form-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-top:0;margin-bottom:20px;color:#2c3e50;font-size:1.3rem}.review-form-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#2c3e50}.review-form-container[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:calc(100% - 16px);padding:10px;border:1px solid #f0f0f0;border-radius:6px;font-size:1rem;resize:vertical;min-height:100px}.review-form-container[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin-top:25px;display:flex;justify-content:flex-end;gap:10px}.btn-cancel[_ngcontent-%COMP%]{background:#f0f0f0;color:#2c3e50}.btn-cancel[_ngcontent-%COMP%]:hover{background:#fafbfc}.addresses-section[_ngcontent-%COMP%]{margin-bottom:24px}.personal-section[_ngcontent-%COMP%]{max-width:500px}.personal-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:18px}.personal-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50;margin-bottom:4px;display:block}.personal-form[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .personal-form[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .personal-form[_ngcontent-%COMP%]   input[type=tel][_ngcontent-%COMP%], .personal-form[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #f0f0f0;border-radius:5px;font-size:1rem;margin-top:2px;color:#2c3e50}.btn-save[_ngcontent-%COMP%]{background:#E31837;color:#fff;border:none;border-radius:4px;padding:8px 18px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s}.btn-save[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-save[_ngcontent-%COMP%]:not(:disabled):hover{background:#c41530}.text-danger[_ngcontent-%COMP%]{color:#e31837;font-size:.97rem;margin-top:2px}.text-success[_ngcontent-%COMP%]{color:#00a642;font-size:.97rem;margin-top:2px}.settings-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px;margin-top:18px}.setting-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.1rem;color:#2c3e50}.btn-change[_ngcontent-%COMP%]{background:#f8b500;color:#fff;border:none;border-radius:4px;padding:6px 14px;font-size:.98rem;cursor:pointer;margin-bottom:10px;transition:background .2s}.btn-change[_ngcontent-%COMP%]:hover{background:#E31837}.password-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:14px}.password-form[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #f0f0f0;border-radius:5px;font-size:1rem;margin-top:2px;color:#2c3e50}.toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:1rem;margin-bottom:8px;cursor:pointer}.toggle[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.toggle[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{width:36px;height:20px;background:#ccc;border-radius:12px;position:relative;transition:background .2s;margin-right:8px}.toggle[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background:#E31837}.toggle[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{content:"";position:absolute;left:2px;top:2px;width:16px;height:16px;background:#fff;border-radius:50%;transition:transform .2s}.toggle[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(16px)}@media (max-width: 900px){.profile-content[_ngcontent-%COMP%]{flex-direction:column;gap:18px;padding:18px}.profile-nav[_ngcontent-%COMP%]{min-width:0;border-right:none;border-bottom:1px solid #f0f0f0;padding-right:0;padding-bottom:12px;margin-bottom:18px}}@media (max-width: 600px){.profile-container[_ngcontent-%COMP%]{padding:0 0 12px}.profile-header[_ngcontent-%COMP%]{padding:18px 10px 14px;min-height:80px}.profile-content[_ngcontent-%COMP%]{padding:8px}.content-area[_ngcontent-%COMP%]{padding:0}}']})}}return r})()}}]);